#include: "rules/snATACseq_cellRanger.smk"
include: "rules/snATACseq_processing.smk"
include: "rules/snATACseq_LDSR.smk"
#include:  "rules/snATACseq_QC_LSI_params.smk" 
include: "rules/snATACseq_LDSR_conditional.smk"	

rule all:
    input:
#        expand("../results/snATACseq_CR-atac_1.2.0/{SAMPLE}.stamp", SAMPLE=config["SAMPLES_ATAC"]),
#        expand("../results/snATACseq_CR-atac_1.2.0/{SAMPLE_AGGR}.aggr", SAMPLE_AGGR=config["SAMPLES_ATAC_AGGR"]),
#        expand("../results/rmarkdown_reports/snATACseq_QC_{REGION}.html", REGION = config['ATAC_REGIONS']), # Can remove this once testing complete
#        expand("../results/rmarkdown_reports/snATACseq_cluster_QC_FC.html"),
#        expand("../results/rmarkdown_reports/snATACseq_unconstrained_integration_{REGION}.html", REGION = config['ATAC_REGIONS']), 
#        expand("../results/rmarkdown_reports/snATACseq_pseudo-bulk-reps_and_peak_calling_{REGION}.html", REGION = config['ATAC_REGIONS']),
#        expand("../results/rmarkdown_reports/snATACseq_cluster_ID_geneExpMatrix_{REGION}.html", REGION = config['ATAC_REGIONS']),
#        expand("../results/rmarkdown_reports/snATACseq_call_peaks_ext_500bp_{REGION}.html", REGION = config['ATAC_REGIONS']),
#        "../results/rmarkdown_reports/snATACseq_additional_analyses.html" ,
#        expand("../results/rmarkdown_reports/snATACseq_LDSR_baseline.v1.2_{EXT}_report.html", EXT = config['PEAK_EXTENSION']),
#        expand("../results/rmarkdown_reports/snATACseq_remove_batch_effects_{REGION}.html", REGION = config['ATAC_REGIONS']), # Can remove this once testing complete
#        expand("../results/rmarkdown_reports/snATACseq_unconstrained_integration_{REGION}.html", REGION = config['ATAC_REGIONS']) 
#         expand("../results/rmarkdown_reports/QC_LSI_params/snATACseq_QC_{REGION}_LSI_{LSI_PARAM}.html", REGION = config['ATAC_REGIONS'], LSI_PARAM = config['LSI_PARAMS'])
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.ExN_vs_FC.InN_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.ExN_vs_FC.RG_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.InN_vs_FC.ExN_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.InN_vs_FC.RG_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.RG_vs_FC.ExN_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_FC.RG_vs_FC.InN_{EXT}_{GWAS}_baseline.v1.2.results",  EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS']),
        expand("../results/LDSR/part_herit/baseline_v1.2/conditional/snATACseq_LDSR_baseline.v1.2_{EXT}_summary_{GWAS}.tsv", EXT = config['PEAK_EXTENSION'], GWAS = config['LDSC_GWAS'])
