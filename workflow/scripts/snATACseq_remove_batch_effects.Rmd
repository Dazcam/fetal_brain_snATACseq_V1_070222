---
title: "snATAC ArchR: remove batch effects report - `r REGION`"
author: "Darren Cameron"
date: "`r format(Sys.time(), '%d/%m/%y')`"
output:
  html_document:
    theme: paper
---

```{r packages, echo=FALSE, include=FALSE}
library(SingleCellExperiment)
library(scater)
library(cowplot)
library(knitr)
```

snATACseq analysis with ArchR - batch correction.

*** 

### Results {.tabset}

#### Cluster plots {.tabset}

```{R, Clusters, echo=FALSE, , fig.height = 10, fig.width = 10}
print(group_plot)
```

***

**Batch corrected cell counts per cluster**

```{R, Cluster_cnts_harmony, echo=FALSE}
knitr::kable(clusters_cnts_harmony)
```

***

**Compare**

```{R, Cluster_CM_harmony_compare, echo=FALSE}
clust_cM_harmony_compare
```

***

#### UMAPs

```{R, UMAP_per_gene, echo=FALSE, fig.height = 10, fig.width = 10}
print(do.call(cowplot::plot_grid, c(list(ncol = 3), all_genes_UMAP)))
```

***

#### Unconstrained Integration 

**Cluster mappings**

```{R, GeneExp_df, echo=FALSE, warning=FALSE}
knitr::kable(integration_df)
```

***

**Cell counts**

```{R, GeneExp_cM, echo=FALSE}
clust_CM_geneExp
```

***

**UMAP**

```{R, integration_UMAP, echo=FALSE}
clusters_UMAP
```

***

