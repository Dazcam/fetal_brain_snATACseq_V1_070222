---
title: "snATACseq ArchR: Cluster QC 1 report - `r REGION`"
author: "Darren Cameron"
date: "`r format(Sys.time(), '%d/%m/%y')`"
output: 
  html_document:
    theme: paper
---



```{r packages, echo=FALSE, include=FALSE}
library(SingleCellExperiment)
library(scater)
library(cowplot)
library(knitr)
```


snATACseq analysis with ArchR - cluster QC 1.

*** 


### Results {.tabset}

***

#### Cluster QC {.tabset}

Remove clusters that do not have >= 30 cells in at least 2 donors

+ Cell count before filter = `r length(archR$cellNames)`
+ Clusters to be retained from initial QC pass  = `r cluster_list`
+ No. of cells to be removed = `r length(archR$cellNames) - length(cells_to_keep)`
+ Cell count after filter = `r length(archR.2$cellNames)`

***

**Cell counts per donor in each cluster after cluster QC**

```{R, Cluster_CM_reClust, echo=FALSE}
re_clust_CM_LSI
```

***


#### Cluster plots

```{R, Clusters, echo=FALSE, , fig.height = 10, fig.width = 10}
print(group_plot)
```

***
